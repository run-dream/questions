### 你能说一下操作系统的启动和初始化过程吗？

关键字: ***BIOS*** ***Bootload*** ***内核初始化***

回答:

1. BIOS 

   - 自检
   - 建立中断向量表和中断服务程序

2. Bootloader 如 Grub2

   - 加载操作系统启动所需的引导扇区
   - 并将CPU从实模式切换到保护模式
   - 建立分段分页
   - 打开地址线
   - 选择操作系统

3. Linux 内核初始化

   - 初始化0号进程

   - 初始化中断处理模块,内存管理模块，进程管理模块，文件系统

   - 其他初始化，包括初始化用户态的祖先进程1号进程以及内核态的祖先进程2号进程


### 请问进程和线程的概念和区别是什么

关键字: ***作用***  ***开销***  ***共享空间***

回答：

概念：

进程即进行中的程序，线程是进程中一个单一顺序的控制流。

线程是进程中的一部分，一个进程可以有多个线程，但线程只能存在于一个进程中。

区别：

1. 根本区别：

   进程是操作系统资源调度（文件，文件系统，信号，信号处理函数，内存）的基本单位

   线程是任务的调度（CPU）执行的基本单位

2. 开销方面：

   进程有自己的独立数据空间，程序之间的切换开销大；

   线程也有自己的运行栈和程序计数器，线程间的切换开销较小。

3. 共享空间：

   进程拥有各自独立的地址空间、资源，所以共享复杂，需要用IPC，但是同步简单。

   而线程共享所属进程的资源，因此共享简单，但是同步复杂，需要用加锁等措施。

在linux中，进程和线程都属于任务，不同的是创建进程的话，调用的系统调用是 fork，在 copy_process 函数里面，会将五大结构 files_struct、fs_struct、sighand_struct、signal_struct、mm_struct 都复制一遍，从此父进程和子进程各用各的数据结构。

而创建线程的话，调用的是系统调用 clone，在 copy_process 函数里面， 五大结构仅仅是引用计数加一，也即线程共享进程的数据结构。



### 线程池是不是越大越好

并不是配置越大越好，而是要根据任务的属性来进行划分：

- 如果是 CPU 密集型任务应当分配较少的线程，比如 CPU 个数相当的大小
- 如果是 IO 密集型任务，由于线程并不是一直在运行，所以可以尽可能的多配置线程，比如 CPU 个数 * 2 



### 请问函数调用堆栈的原理是什么

关键字: ***栈桢***  ***寄存器***

当调用一个函数时，将创建一个栈桢来支持该函数的执行。栈桢包含函数的局部变量和调用者传递给函数的参数。栈桢还包含管理信息，允许被调用的函数(被调用方)安全地返回给调用方。

计算机通过保存以及还原 CPU的栈指针和基址指针寄存器的相互配合来实现了指令的栈式调用。



### 怎么排查接口调用性能